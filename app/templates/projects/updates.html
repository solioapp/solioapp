{% extends "base.html" %}

{% block title %}Updates - {{ project.title }} - Solio{% endblock %}

{% block content %}
<div class="container page-container">
    <div class="page-header align-left">
        <nav class="breadcrumb">
            <a href="{{ url_for('projects.list_projects') }}">Projects</a>
            <span>/</span>
            <a href="{{ url_for('projects.detail', slug=project.slug) }}">{{ project.title }}</a>
            <span>/</span>
            <span>Updates</span>
        </nav>
        <h1>Project Updates</h1>
        <p>{{ project.title }}</p>
    </div>

    {% if current_user.is_authenticated and current_user.id == project.user_id %}
    <div class="updates-actions">
        <a href="{{ url_for('projects.create_update', id=project.id) }}" class="btn btn-primary">
            + Post New Update
        </a>
    </div>
    {% endif %}

    {% if updates %}
    <div class="updates-list">
        {% for update in updates %}
        <article class="update-card">
            <div class="update-header">
                <h2 class="update-title">{{ update.title }}</h2>
                <div class="update-meta">
                    <span class="update-date">
                        <svg viewBox="0 0 24 24" width="14" height="14">
                            <path fill="currentColor" d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10 10-4.5 10-10S17.5 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm.5-13H11v6l5.2 3.2.8-1.3-4.5-2.7V7z"/>
                        </svg>
                        {{ update.created_at.strftime('%B %d, %Y') }}
                    </span>
                    {% if current_user.is_authenticated and current_user.id == project.user_id %}
                    <div class="update-actions">
                        <a href="{{ url_for('projects.edit_update', id=project.id, uid=update.id) }}" class="btn btn-sm btn-outline">Edit</a>
                        <form action="{{ url_for('projects.delete_update', id=project.id, uid=update.id) }}" method="POST" class="inline-form"
                              onsubmit="return confirm('Are you sure you want to delete this update?')">
                            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                            <button type="submit" class="btn btn-sm btn-danger">Delete</button>
                        </form>
                    </div>
                    {% endif %}
                </div>
            </div>
            <div class="update-content rich-text">
                {{ update.content|safe }}
            </div>
        </article>
        {% endfor %}
    </div>
    {% else %}
    <div class="empty-state">
        <div class="empty-icon">ğŸ“</div>
        <h2>No Updates Yet</h2>
        <p>The project creator hasn't posted any updates yet.</p>
        {% if current_user.is_authenticated and current_user.id == project.user_id %}
        <a href="{{ url_for('projects.create_update', id=project.id) }}" class="btn btn-primary">
            Post First Update
        </a>
        {% endif %}
    </div>
    {% endif %}

    <div class="back-link">
        <a href="{{ url_for('projects.detail', slug=project.slug) }}">&larr; Back to Project</a>
    </div>
</div>
{% endblock %}
